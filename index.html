<!DOCTYPE html>
<html lang="no">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pengesystemet og Inflasjon</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #f0f2f5;
        }
        .card {
            background: white;
            border-radius: 12px;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            overflow: hidden;
            margin-bottom: 2rem;
        }
        .canvas-container {
            position: relative;
            background: #ffffff;
            border-radius: 8px;
            overflow: hidden;
            border: 1px solid #e5e7eb;
        }
        .toggle-btn {
            transition: all 0.3s ease;
        }
        .toggle-btn.active {
            background-color: #3b82f6;
            color: white;
            border-color: #3b82f6;
        }
        .slider-thumb::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 20px;
            height: 20px;
            background: #3b82f6;
            cursor: pointer;
            border-radius: 50%;
        }
        /* --- Graf Fix --- */
        .bar-container {
            display: flex;
            align-items: flex-end; /* Juster alt til bunnen */
            height: 250px;
            gap: 4px;
            padding-bottom: 30px; /* Plass til labels */
            border-bottom: 2px solid #e5e7eb;
            position: relative;
        }
        .bar-wrapper {
            flex: 1;
            height: 100%; /* Viktig: M√• fylle h√∏yden for at %-h√∏yde p√• barnet skal virke */
            display: flex;
            flex-direction: column;
            justify-content: flex-end; /* Press s√∏ylen ned */
            align-items: center;
            position: relative;
        }
        .bar {
            width: 80%;
            background: #3b82f6;
            border-radius: 4px 4px 0 0;
            transition: height 0.5s ease, background-color 0.3s ease;
            position: relative;
        }
        .bar-label {
            position: absolute;
            bottom: -25px;
            font-size: 0.7rem;
            color: #6b7280;
            white-space: nowrap;
            transform: rotate(-45deg); /* Roter tekst for bedre plass */
            transform-origin: top left;
        }
        .tooltip {
            position: absolute;
            background: rgba(0,0,0,0.8);
            color: white;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 0.75rem;
            bottom: 100%;
            margin-bottom: 4px;
            display: none;
            z-index: 10;
            pointer-events: none;
            white-space: nowrap;
        }
        .bar-wrapper:hover .tooltip {
            display: block;
        }
    </style>
</head>
<body class="p-4 md:p-8 max-w-5xl mx-auto">

    <header class="text-center mb-10">
        <h1 class="text-3xl md:text-4xl font-bold text-gray-800 mb-2">Pengesystemet og Inflasjon</h1>
        <p class="text-gray-600">Interaktiv forklaring basert p√• kapittel om Demografi og √òkonomi</p>
    </header>

    <!-- DEL 1: PENGESYSTEMET -->
    <section class="card p-6">
        <div class="flex flex-col md:flex-row justify-between items-start md:items-center mb-6">
            <div>
                <h2 class="text-2xl font-bold text-gray-800 flex items-center gap-2">
                    <span class="bg-blue-100 text-blue-600 p-2 rounded-lg text-xl">üí∞</span>
                    Fra Byttehandel til Penger
                </h2>
                <p class="text-gray-600 mt-1 text-sm">Se hvorfor "Naturalhandel" er ineffektivt sammenlignet med et pengesystem.</p>
            </div>
            <div class="flex bg-gray-100 p-1 rounded-lg mt-4 md:mt-0">
                <button onclick="setTradeMode('barter')" id="btn-barter" class="toggle-btn active px-4 py-2 rounded-md text-sm font-medium border border-transparent">Naturalhandel</button>
                <button onclick="setTradeMode('money')" id="btn-money" class="toggle-btn px-4 py-2 rounded-md text-sm font-medium border border-transparent text-gray-600 hover:text-gray-900">Pengesystem</button>
            </div>
        </div>

        <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
            <div class="lg:col-span-2">
                <div class="canvas-container h-[400px] relative" id="canvas-wrapper">
                    <canvas id="tradeCanvas"></canvas>
                </div>
            </div>
            
            <div class="bg-blue-50 p-6 rounded-xl border border-blue-100">
                <h3 class="font-bold text-blue-900 mb-3 text-lg" id="info-title">Problemet med Naturalhandel</h3>
                <div id="info-content" class="text-blue-800 text-sm space-y-4">
                    <p>I PDF-en (s. 32) m√∏ter vi <strong>Eggebonden</strong> som vil ha sko.</p>
                    <ul class="list-disc pl-4 space-y-2">
                        <li>Skomakeren vil ikke ha egg, men ost.</li>
                        <li>Ostebonden vil ikke ha egg, men melk.</li>
                        <li>Melkebonden vil ikke ha egg, men hvete.</li>
                    </ul>
                    <p class="font-semibold mt-4 border-t border-blue-200 pt-3">Konklusjon:</p>
                    <p>Eggebonden m√• gjennomf√∏re <strong>4 bytter</strong> bare for √• f√• seg ett par sko! Dette er sv√¶rt ineffektivt.</p>
                </div>
            </div>
        </div>
    </section>

    <!-- DEL 2: INFLASJON -->
    <section class="card p-6">
        <div class="mb-6">
            <h2 class="text-2xl font-bold text-gray-800 flex items-center gap-2">
                <span class="bg-red-100 text-red-600 p-2 rounded-lg text-xl">üìà</span>
                Hva er Inflasjon?
            </h2>
            <p class="text-gray-600 mt-1">Inflasjon er en √∏kning i pengemengden som gj√∏r at pengene mister verdi over tid (s. 36).</p>
        </div>

        <div class="grid grid-cols-1 lg:grid-cols-12 gap-8">
            <!-- Controls -->
            <div class="lg:col-span-4 space-y-6 bg-gray-50 p-6 rounded-xl border border-gray-100">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Startbel√∏p (i madrassen)</label>
                    <div class="relative">
                        <span class="absolute left-3 top-2.5 text-gray-500">kr</span>
                        <input type="number" id="input-amount" value="1000" class="w-full pl-8 pr-3 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500" oninput="updateInflation()">
                    </div>
                </div>

                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Antall √•r frem i tid: <span id="val-years" class="text-blue-600 font-bold">20</span> √•r</label>
                    <input type="range" id="input-years" min="5" max="50" value="20" class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer slider-thumb" oninput="updateInflation()">
                </div>

                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">√Örlig inflasjon: <span id="val-rate" class="text-blue-600 font-bold">2.0</span>%</label>
                    <input type="range" id="input-rate" min="0" max="15" value="2" step="0.5" class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer slider-thumb" oninput="updateInflation()">
                    <div class="flex justify-between text-xs text-gray-500 mt-1">
                        <span>0%</span>
                        <span class="text-green-600 font-semibold cursor-pointer hover:underline" onclick="setRate(2)">Norges Bank M√•l (2%)</span>
                        <span>15%</span>
                    </div>
                </div>

                <div class="bg-white p-4 rounded-lg border border-gray-200 shadow-sm">
                    <h4 class="text-xs font-semibold text-gray-500 uppercase tracking-wider mb-2">Resultat</h4>
                    <p class="text-sm text-gray-600">Om <span id="res-years">20</span> √•r vil dine <span id="res-start">1000</span> kr ha en kj√∏pekraft tilsvarende:</p>
                    <p class="text-3xl font-bold text-gray-800 mt-1"><span id="res-end">673</span> kr</p>
                    <p class="text-xs text-red-500 mt-2 flex items-center gap-1">
                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 17h8m0 0V9m0 8l-8-8-4 4-6-6"></path></svg>
                        Verditap: <span id="res-loss">327</span> kr
                    </p>
                </div>
            </div>

            <!-- Visualization -->
            <div class="lg:col-span-8 flex flex-col justify-end">
                <div class="bg-white p-4 rounded-xl">
                    <h3 class="text-center font-medium text-gray-500 mb-8">Utvikling av kj√∏pekraft over tid</h3>
                    <div id="inflation-chart" class="bar-container px-4">
                        <!-- Bars injected by JS -->
                    </div>
                    <div class="mt-6 p-4 bg-yellow-50 rounded-lg border border-yellow-100 text-sm text-yellow-800">
                        <strong>Fra l√¶reboken (s. 38):</strong> "Inflasjon gj√∏r det vanskeligere √• spare, men bel√∏nner dem som tar opp l√•n."
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- DEL 3: √òSTERRIKSK √òKONOMI -->
    <section class="card p-8 bg-amber-50 border border-amber-100">
        <div class="mb-8">
            <h2 class="text-2xl font-bold text-amber-900 flex items-center gap-2">
                <span class="bg-amber-200 text-amber-800 p-2 rounded-lg text-xl">üèõÔ∏è</span>
                Det √òsterrikske Perspektivet
            </h2>
            <p class="text-amber-800 mt-2">I den "√∏sterrikske skolen" (en retning innen √∏konomi) ser man p√• inflasjon og penger litt annerledes enn i dagens skoleb√∏ker.</p>
        </div>

        <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
            <!-- Kolonne 1 -->
            <div class="space-y-6">
                <div class="bg-white p-5 rounded-lg shadow-sm border border-amber-100">
                    <h3 class="font-bold text-lg text-amber-900 mb-2">1. Inflasjon er ikke prisvekst</h3>
                    <p class="text-sm text-gray-700">
                        I dag sier vi at inflasjon er n√•r prisene stiger. √òsterrikerne mener dette er feil. De sier at <strong>inflasjon er n√•r man √∏ker pengemengden</strong> (trykker mer penger). <br><br>
                        Prisvekst er bare et <em>symptom</em> p√• at det finnes flere penger som jager de samme varene.
                    </p>
                </div>

                <div class="bg-white p-5 rounded-lg shadow-sm border border-amber-100">
                    <h3 class="font-bold text-lg text-amber-900 mb-2">2. Cantillon-effekten (Urettferdighet)</h3>
                    <p class="text-sm text-gray-700">
                        N√•r nye penger lages, blir de ikke delt ut likt til alle samtidig.
                    </p>
                    <ul class="list-disc pl-4 mt-2 text-sm text-gray-700 space-y-1">
                        <li><strong>Vinnerne:</strong> De som f√•r de nye pengene f√∏rst (ofte staten, banker og store investorer). De kan kj√∏pe varer til <em>gamle, lave priser</em>.</li>
                        <li><strong>Taperne:</strong> Vanlige folk (l√∏nnsmottakere og pensjonister) f√•r pengene sist. N√•r pengene n√•r dem, har prisene i butikken allerede steget.</li>
                    </ul>
                    <p class="text-xs text-amber-700 mt-2 italic">Dette fungerer som en skjult skatt fra de fattige til de rike.</p>
                </div>
            </div>

            <!-- Kolonne 2 -->
            <div class="space-y-6">
                <div class="bg-white p-5 rounded-lg shadow-sm border border-amber-100">
                    <h3 class="font-bold text-lg text-amber-900 mb-2">3. Pengers tidsreise (Regresjonsteoremet)</h3>
                    <p class="text-sm text-gray-700 mb-3">
                        Hvorfor har en papirlapp verdi? Ludwig von Mises forklarte dette med sin <em>Regresjonsanalyse</em>:
                    </p>
                    <div class="relative pl-6 border-l-4 border-amber-300 space-y-3">
                        <div>
                            <span class="text-xs font-bold uppercase text-amber-600">I dag</span>
                            <p class="text-sm text-gray-600">Penger har verdi fordi de hadde kj√∏pekraft i g√•r.</p>
                        </div>
                        <div>
                            <span class="text-xs font-bold uppercase text-amber-600">I g√•r</span>
                            <p class="text-sm text-gray-600">De hadde verdi i g√•r fordi de hadde verdi dagen f√∏r.</p>
                        </div>
                        <div>
                            <span class="text-xs font-bold uppercase text-amber-600">Opprinnelsen</span>
                            <p class="text-sm text-gray-600">
                                Hvis vi g√•r langt nok tilbake, m√• pengene ha startet som en <strong>vare</strong> (som gull eller s√∏lv) som folk √∏nsket seg <em>f√∏r</em> det ble penger.
                            </p>
                        </div>
                    </div>
                    <p class="text-sm text-gray-700 mt-4">
                        <strong>Konklusjon:</strong> Staten kan ikke bare vedta at noe har verdi. Ekte penger m√• ha oppst√•tt frivillig i markedet fordi varen var verdifull i seg selv. N√•r vi forlater denne koblingen (f.eks. g√•r vekk fra gullstandarden), risikerer vi at pengene mister all verdi over tid.
                    </p>
                </div>
            </div>
        </div>
    </section>

    <script>
        /* =========================================
           DEL 1: CANVAS HANDEL VISUALISERING
           ========================================= */
        const canvas = document.getElementById('tradeCanvas');
        const ctx = canvas.getContext('2d');
        let mode = 'barter';
        
        const nodes = [
            { id: 'egg', label: 'Eggebonde', icon: 'ü•ö', color: '#FEF3C7', border: '#D97706' },
            { id: 'hvete', label: 'Hvetebonde', icon: 'üåæ', color: '#DCFCE7', border: '#16A34A' },
            { id: 'melk', label: 'Melkebonde', icon: 'ü•õ', color: '#DBEAFE', border: '#2563EB' },
            { id: 'ost', label: 'Ostebonde', icon: 'üßÄ', color: '#FFEDD5', border: '#EA580C' },
            { id: 'sko', label: 'Skomaker', icon: 'üëû', color: '#F3E8FF', border: '#9333EA' }
        ];

        const moneyNode = { id: 'money', label: 'PENGER', icon: 'üí∞', color: '#FFD700', border: '#B45309' };
        let packets = []; 

        function resizeCanvas() {
            const container = document.getElementById('canvas-wrapper');
            canvas.width = container.offsetWidth;
            canvas.height = container.offsetHeight;
        }
        window.addEventListener('resize', resizeCanvas);
        resizeCanvas();

        function getNodePositions() {
            const cx = canvas.width / 2;
            const cy = canvas.height / 2;
            const radius = Math.min(cx, cy) - 60;
            return nodes.map((node, i) => {
                const angle = (i * 2 * Math.PI / nodes.length) - (Math.PI / 2);
                return { ...node, x: cx + Math.cos(angle) * radius, y: cy + Math.sin(angle) * radius };
            });
        }

        function drawArrow(fromX, fromY, toX, toY, color) {
            const headLength = 10;
            const dx = toX - fromX;
            const dy = toY - fromY;
            const angle = Math.atan2(dy, dx);
            const padding = 45;
            const startX = fromX + Math.cos(angle) * padding;
            const startY = fromY + Math.sin(angle) * padding;
            const endX = toX - Math.cos(angle) * padding;
            const endY = toY - Math.sin(angle) * padding;

            ctx.beginPath();
            ctx.moveTo(startX, startY);
            ctx.lineTo(endX, endY);
            ctx.strokeStyle = color;
            ctx.lineWidth = 2;
            ctx.stroke();

            ctx.beginPath();
            ctx.moveTo(endX, endY);
            ctx.lineTo(endX - headLength * Math.cos(angle - Math.PI / 6), endY - headLength * Math.sin(angle - Math.PI / 6));
            ctx.lineTo(endX - headLength * Math.cos(angle + Math.PI / 6), endY - headLength * Math.sin(angle + Math.PI / 6));
            ctx.fillStyle = color;
            ctx.fill();
        }

        function drawNode(node) {
            ctx.beginPath();
            ctx.arc(node.x, node.y, 35, 0, 2 * Math.PI);
            ctx.fillStyle = node.color;
            ctx.fill();
            ctx.lineWidth = 2;
            ctx.strokeStyle = node.border;
            ctx.stroke();
            ctx.font = '24px Arial';
            ctx.textAlign = 'center';
            ctx.textBaseline = 'middle';
            ctx.fillStyle = '#000';
            ctx.fillText(node.icon, node.x, node.y);
            ctx.font = 'bold 12px sans-serif';
            ctx.fillStyle = '#374151';
            ctx.fillText(node.label, node.x, node.y + 50);
        }

        function spawnPacket(startNode, endNode, color) {
            packets.push({ x: startNode.x, y: startNode.y, targetX: endNode.x, targetY: endNode.y, color: color, progress: 0, speed: 0.02 });
        }

        function render() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            const positionedNodes = getNodePositions();
            const centerNode = { ...moneyNode, x: canvas.width/2, y: canvas.height/2 };

            if (mode === 'barter') {
                for (let i = 0; i < positionedNodes.length; i++) {
                    const current = positionedNodes[i];
                    const next = positionedNodes[(i + 1) % positionedNodes.length];
                    drawArrow(current.x, current.y, next.x, next.y, '#9CA3AF');
                }
            } else {
                drawNode(centerNode);
                positionedNodes.forEach(node => {
                    drawArrow(node.x, node.y, centerNode.x, centerNode.y, '#10B981');
                });
            }

            positionedNodes.forEach(drawNode);

            packets.forEach((pkt, index) => {
                pkt.progress += pkt.speed;
                const curX = pkt.x + (pkt.targetX - pkt.x) * pkt.progress;
                const curY = pkt.y + (pkt.targetY - pkt.y) * pkt.progress;
                ctx.beginPath(); ctx.arc(curX, curY, 6, 0, 2*Math.PI); ctx.fillStyle = pkt.color; ctx.fill();
                if(pkt.progress >= 1) packets.splice(index, 1);
            });

            if (Math.random() < 0.03) {
                if (mode === 'barter') {
                    const idx = Math.floor(Math.random() * positionedNodes.length);
                    spawnPacket(positionedNodes[idx], positionedNodes[(idx + 1) % positionedNodes.length], '#EF4444');
                } else {
                    const idx = Math.floor(Math.random() * positionedNodes.length);
                    if (Math.random() > 0.5) spawnPacket(positionedNodes[idx], centerNode, '#3B82F6');
                    else spawnPacket(centerNode, positionedNodes[idx], '#F59E0B');
                }
            }
            requestAnimationFrame(render);
        }

        function setTradeMode(newMode) {
            mode = newMode;
            packets = [];
            document.getElementById('btn-barter').className = `toggle-btn px-4 py-2 rounded-md text-sm font-medium border border-transparent ${mode === 'barter' ? 'active shadow-sm' : 'text-gray-600 hover:text-gray-900'}`;
            document.getElementById('btn-money').className = `toggle-btn px-4 py-2 rounded-md text-sm font-medium border border-transparent ${mode === 'money' ? 'active shadow-sm' : 'text-gray-600 hover:text-gray-900'}`;
            
            const title = document.getElementById('info-title');
            const content = document.getElementById('info-content');
            if (mode === 'barter') {
                title.innerText = "Problemet med Naturalhandel";
                content.innerHTML = `<p>I PDF-en (s. 32) m√∏ter vi Eggebonden. Han m√• bytte 4 ganger f√∏r han f√•r sko.</p><p class="font-semibold mt-2 text-red-600">Resultat: Tregt.</p>`;
            } else {
                title.innerText = "L√∏sningen: Penger";
                content.innerHTML = `<p>Med penger selger Eggebonden eggene direkte. Handelen skjer umiddelbart.</p><p class="font-semibold mt-2 text-green-600">Resultat: Effektivt!</p>`;
            }
        }
        render();

        /* =========================================
           DEL 2: INFLASJON KALKULATOR
           ========================================= */
        function setRate(val) {
            document.getElementById('input-rate').value = val;
            updateInflation();
        }

        function updateInflation() {
            const startAmount = parseFloat(document.getElementById('input-amount').value);
            const years = parseInt(document.getElementById('input-years').value);
            const rate = parseFloat(document.getElementById('input-rate').value);

            document.getElementById('val-years').innerText = years;
            document.getElementById('val-rate').innerText = rate.toFixed(1);
            document.getElementById('res-years').innerText = years;
            document.getElementById('res-start').innerText = startAmount.toLocaleString();

            const futureValue = startAmount / Math.pow(1 + rate/100, years);
            document.getElementById('res-end').innerText = Math.round(futureValue).toLocaleString();
            document.getElementById('res-loss').innerText = Math.round(startAmount - futureValue).toLocaleString();

            renderChart(startAmount, years, rate);
        }

        function renderChart(amount, years, rate) {
            const container = document.getElementById('inflation-chart');
            container.innerHTML = '';

            const steps = 10;
            const yearStep = Math.max(1, Math.floor(years / steps));
            
            for (let i = 0; i <= years; i += yearStep) {
                const val = amount / Math.pow(1 + rate/100, i);
                const heightPercentage = (val / amount) * 100;
                
                let colorClass = '#3b82f6';
                if (rate > 5) colorClass = '#ef4444'; 
                else if (rate <= 2) colorClass = '#10b981';

                const wrapper = document.createElement('div');
                wrapper.className = 'bar-wrapper';
                
                wrapper.innerHTML = `
                    <div class="tooltip">√Ör ${i}: ${Math.round(val)} kr</div>
                    <div class="bar" style="height: ${heightPercentage}%; background-color: ${colorClass}"></div>
                    <div class="bar-label">√Ör ${i}</div>
                `;
                
                container.appendChild(wrapper);
            }
        }

        updateInflation();
    </script>
</body>
</html>
